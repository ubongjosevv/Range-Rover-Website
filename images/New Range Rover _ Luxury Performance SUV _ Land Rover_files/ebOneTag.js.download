var ajax;EBG="undefined"!=typeof EBG?EBG:{},EBG.Semi=EBG.Semi||{},EBG.Semi.Infra=function(){},EBG.Semi.Infra.declareNamespace=function(e){for(var t=window.EBG.Semi,i=e.split("."),n=0;n<i.length;n++){var r=i[n],a=t[r];a||(a=t[r]={}),t=a}},EBG.Semi.Infra.isDefined=function(e){return void 0!==e},EBG.Semi.Infra.isDefinedNotNull=function(e){return EBG.Semi.Infra.isDefined(e)&&null!=e},EBG.Semi.Infra.runTimed=function(e,t,i,n){return setTimeout((function(){t.apply(e,i)}),n)},EBG.Semi.Infra.indexOfArray=function(e,t,i){for(var n=i||0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},EBG.Semi.Infra.getTimestamp=function(){var e=new Date;return parseInt(e.getHours()+1)+":"+e.getMinutes()+":"+e.getSeconds()+"."+e.getMilliseconds()+" "+e.getDate()+"."+parseInt(e.getMonth()+1)+"."+e.getFullYear()},EBG.Semi.Infra.getQuerystringParam=function(e,t){if(!e)return null;t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},EBG.Semi.Infra.getValueFromPath=function(e){try{e=e.split(".");for(var t=window,i=0;i<e.length;i++)t=t[e[i]];return t}catch(e){}return null},EBG.Semi.Infra.getUrlParameter=function(e){var t="",i=EBG.Semi.Infra.getWindowLocation().toString(),n=new RegExp("[&,?]"+e+"=(.*)[&]","i"),r=new RegExp("[&,?]"+e+"=(.*)$","i"),a=i.match(n)||i.match(r);return a&&a.length>0&&(a[1].indexOf("&")>-1&&(a[1]=a[1].substr(0,a[1].indexOf("&"))),t=a[1]),t},EBG.Semi.Infra.mergeObj=function(e,t,i){for(var n in i=!!i,e)e.hasOwnProperty(n)&&(t.hasOwnProperty(n)&&!i||(t[n]=e[n]))},EBG.Semi.Infra.combinePaths=function(e,t){t=t||"",(e=e||"")&&"/"!=e[e.length-1]&&t&&"/"!=t[0]&&(e+="/");var i=e;return t&&(i+=t),i},EBG.Semi.Infra.isPageLoaded=function(){var e=!0;return"complete"!=document.readyState&&"loaded"!=document.readyState&&"interactive"!=document.readyState&&(e=!1),e},EBG.Semi.Infra.addChildToPage=function(e,t,i,n){void 0!==t&&t||(t=document.body||document.getElementsByTagName("head")[0]),this.isDefined(i)&&null!=i&&this.addEventListener(e,i,n),t.appendChild(e)},EBG.Semi.Infra.addEventListener=function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):(t="on"+t,e.attachEvent?e.attachEvent(t,i):t in e&&(e[t]=i))},EBG.Semi.Infra.createScriptElement=function(e,t,i,n){try{var r=e.createElement(t);return r.type=i,r.src=n,r.async=!1,r}catch(e){}},EBG.Semi.Infra.addScriptElement=function(e,t,i){var n,r,a=i||document;if(t){if(0==(n=t).childNodes.length){var s=a.createElement("div");s.style.display="none",t.appendChild(s)}}else n=a.head||a.documentElement;r=n.firstChild,n.insertBefore(e,r)},EBG.Semi.Infra.ajax=(ajax={x:function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;for(var e,t=["MSXML2.XmlHttp.6.0","MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],i=0;i<t.length;i++)try{e=new ActiveXObject(t[i]);break}catch(e){}return e},send:function(e,t,i,n,r,a){void 0===r&&(r=!0),a=a||{timeout:0};var s=ajax.x(),o=!1;s.open(i,e,r),s.timeout=a.timeout||0,s.onreadystatechange=function(){o||4!=s.readyState||(o=!0,t(s.responseText,s,s.status&&s.timeout&&(new Date).getTime()-c>=s.timeout))},"POST"==i&&s.setRequestHeader("Content-type","application/x-www-form-urlencoded");var c=(new Date).getTime();s.send(n)},get:function(e,t,i,n,r){var a=[];for(var s in t)a.push(encodeURIComponent(s)+"="+encodeURIComponent(t[s]));ajax.send(e+(a.length?"?"+a.join("&"):""),i,"GET",null,n,r)},post:function(e,t,i,n,r){var a=[];for(var s in t)a.push(encodeURIComponent(s)+"="+encodeURIComponent(t[s]));ajax.send(e,i,"POST",a.join("&"),n,r)}},ajax),EBG.Semi.Infra.injectScript=function(e){e="<html><head></head><body><script>window.onerror=function(r,n,a,e,o){try{parent.versaTagObj._handleUnhandledError(new Error(r,n,a),2);}catch(r){}};<\/script>"+e+"</body></html>";var t=this.createFriendlyIframe();this.addChildToPage(t),document.documentMode&&7<document.documentMode&&!this.isIframeScriptable(t)&&this.enableIframeScriptable(t),this.writeToFriendlyIframe(t,e,!0)},EBG.Semi.Infra.loadFileByScriptElem=function(e,t,i,n,r,a){if(n)(e=e||document).write("<script src='"+t+"'><\/script>"),e.close();else{var s=(e=e||document).createElement("script");s.type="text/"+(t.type||"javascript"),s.src=t.src||t,s.async=!0;var o=!1;s.onreadystatechange=s.onload=function(){var e=s.readyState;!i||o||e&&!/loaded|complete/.test(e)||(o=!0,i.apply(r,[a]))},s.onerror=function(){i.apply(r,[a])},EBG.Semi.Infra.addChildToPage(s,e.body||e.getElementsByTagName("head")[0])}},EBG.Semi.Infra.isTextScriptValid=function(e){try{return Function(e),!0}catch(e){return!1}},EBG.Semi.Infra.executeTextByScriptElem=function(e,t,i,n){if(EBG.Semi.Infra.isTextScriptValid(t)){var r=(e=e||document).createElement("script");r.type="text/javascript",r.text=t,EBG.Semi.Infra.addChildToPage(r,e.body||e.getElementsByTagName("head")[0]),i&&setTimeout((function(){i.apply(n||window,[null])}),10)}else i.apply(n||window,[new Error("Syntax Error : "+t)])},EBG.Semi.Infra.getWindowLocation=function(){return window.location},EBG.Semi.Infra.getCurrentScriptElement=function(){var e;if(document.currentScript)e=document.currentScript;else for(var t=document.getElementsByTagName("script"),i=0;!e&&i<t.length;i++)-1===t[i].src.indexOf("ebOneTag.js")||t[i].chosen||(t[i].chosen=!0,e=t[i]);return function(){return e}}(),EBG.Semi.Infra.getRandomNumber=function(){try{var e=Math.random().toString();return e=e.substr(e.indexOf(".")+1)}catch(e){}},EBG.Semi.Infra.getAddInEyeDomain=function(e,t){var i="",n="",r=0,a=(e||window).document,s=a.referrer?a.referrer:a.location.href;try{(s=s.toLowerCase()).length>=7&&"http://"==s.substr(0,7)?(n=s.substr(7),s.substr(0,7)):s.length>=8&&"https://"==s.substr(0,8)?(n=s.substr(8),s.substr(0,8)):n=s,(r=n.indexOf("/"))>0&&(n=n.substr(0,r)),i=n}catch(e){i=""}return i},EBG.Semi.Infra.createFriendlyIframe=function(e,t,i,n){var r=(e=e||document).createElement("iframe");return t&&r.setAttribute("id",t),r.style.display=i?"":"none",r.style.width=i?i+"px":"0px",r.style.height=n?n+"px":"0px",document.documentMode&&document.documentMode<8?(r.frameBorder=0,r.margin=0,r.marginWidth=0,r.marginHeight=0,r.scrolling="no",r.ariaHidden="true"):(r.setAttribute("scrolling","no"),r.setAttribute("marginwidth","0"),r.setAttribute("marginheight","0"),r.setAttribute("frameborder","0"),r.setAttribute("aria-hidden","true")),r},EBG.Semi.Infra.isIframeScriptable=function(e){try{this.ifrmDocument=e.contentWindow.document}catch(e){return!1}return!0},EBG.Semi.Infra.enableIframeScriptable=function(e){if(e){e.setAttribute("data-isready","false");var t="javascript:document.write('";t+="<scr'+'ipt>\r",t+='try{parent.document.domain;}catch(e){document.domain="'+document.domain+'";}\r',t+="parent.EBG.Semi.Infra.friendlyIframeIsReadyCallback(window);\r",t+="</scr'+'ipt>\r');",e.src=t}},EBG.Semi.Infra.friendlyIframeIsReadyCallback=function(e){for(var t=document.getElementsByTagName("iframe"),i=0;i<t.length;i++)try{if((t[i].contentWindow||t[i].contentDocument.window||t[i].window)==e){t[i].setAttribute("data-isready","true");break}}catch(e){}},EBG.Semi.Infra.writeToFriendlyIframe=function(e,t,i){if(document.documentMode&&7<document.documentMode&&"false"==e.getAttribute("data-isready"))setTimeout((function(){EBG.Semi.Infra.writeToFriendlyIframe(e,t,i)}),100);else{var n;i=!!this.isDefined(i)&&i,n=e.contentWindow?e.contentWindow.document:e.contentDocument&&e.contentDocument.document?e.contentDocument.document:e.contentDocument;try{n.write(t)}catch(e){}i&&setTimeout((function(){n.close()}),1e3)}},EBG.Semi.Infra.createUnfriendlyIframe=function(e,t,i){if(t&&!EBG.Semi.Infra.isPageLoaded())this.logger&&this.logger.info("Adding unfriendly iframe in sync mode, url: "+e),document.write('<iframe src="'+e+'" aria-hidden="true" style="display:none;width:0px;height:0px"></iframe>');else{this.logger&&this.logger.info("Adding unfriendly iframe in async mode, url: "+e);var n=document.createElement("iframe");n.setAttribute("src",e),n.setAttribute("aria-hidden",!0),n.style.display="none",n.onload=i,EBG.Semi.Infra.addChildToPage(n)}},EBG.Semi.Infra.isPageRefresh=function(){try{return!(!window.performance.navigation||1!==window.performance.navigation.type)||"reload"==window.performance.getEntriesByType("navigation")[0].type}catch(e){return!1}},EBG.Semi.Infra.getTopLevelReferrer=function(e){var t=null;try{if(!(e.top&&e.top.document&&e.top.document.referrer))throw new Error("Unfriendly iframe");t=e.top.document.referrer.toString()}catch(i){this.isDefined(e)&&e.document&&e.document.referrer&&(t=e.document.referrer.toString())}return t},EBG.Semi.Infra.getTokenValueFromURL=function(e,t){var i=t.indexOf("?")?t.split("?")[1]:"";if(i)for(var n=i.split("&"),r=0;r<n.length;r++){var a=n[r].split("=");if(a[0]==e)return a[a.length-1]}return null},EBG.Semi.Infra.urlAvailableLength=function(e){var t=8e3;return EBG.Semi.Infra.isOldIE()&&(t=2048),t-e.length},EBG.Semi.Infra.isOldIE=function(e){var t,i,n,r,a=navigator.userAgent;return-1!=(t=a.indexOf("MSIE"))&&(-1!=(r=(i=a.substring(t+5)).indexOf(";"))&&(i=i.substring(0,r)),-1!=(r=i.indexOf(" "))&&(i=i.substring(0,r)),n=parseInt(""+i,10),isNaN(n)&&(i=""+parseFloat(navigator.appVersion),n=parseInt(navigator.appVersion,10)),n<9)},EBG.Semi.Infra.typeOf=function(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array||!(e instanceof Object)&&"[object Array]"==Object.prototype.toString.call(e)||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if(!(e instanceof Object||"[object Function]"!=Object.prototype.toString.call(e)&&(void 0===e.call||void 0===e.propertyIsEnumerable||e.propertyIsEnumerable("call"))))return"function"}else if("function"==t&&void 0===e.call)return"object";return t},EBG.Semi.declareNamespace=EBG.Semi.Infra.declareNamespace,EBGVT="undefined"!=typeof EBGVT?EBGVT:{},"JSON"in window&&window.JSON&&window.JSON.stringify&&window.JSON.parse?EBGVT.JSON=JSON:EBGVT.JSON={},function(){function f(e){return e<10?"0"+e:e}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(e){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,(function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+e+'"'}function str(e,t){var i,n,r,a,s,o=gap,c=t[e];switch(c&&"object"==typeof c&&"function"==typeof c.toJSON&&(c=c.toJSON(e)),"function"==typeof rep&&(c=rep.call(t,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(c)){for(a=c.length,i=0;i<a;i+=1)s[i]=str(i,c)||"null";return r=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+o+"]":"["+s.join(",")+"]",gap=o,r}if(rep&&"object"==typeof rep)for(a=rep.length,i=0;i<a;i+=1)"string"==typeof(n=rep[i])&&(r=str(n,c))&&s.push(quote(n)+(gap?": ":":")+r);else for(n in c)Object.hasOwnProperty.call(c,n)&&(r=str(n,c))&&s.push(quote(n)+(gap?": ":":")+r);return r=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+o+"}":"{"+s.join(",")+"}",gap=o,r}}"function"!=typeof EBGVT.JSON.stringify&&(EBGVT.JSON.stringify=function(e,t,i){var n;if(gap="",indent="","number"==typeof i)for(n=0;n<i;n+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("EBGVT.JSON.stringify");return str("",{"":e})}),"function"!=typeof EBGVT.JSON.parse&&(EBGVT.JSON.parse=function(text,reviver){var j;function walk(e,t){var i,n,r=e[t];if(r&&"object"==typeof r)for(i in r)Object.hasOwnProperty.call(r,i)&&(void 0!==(n=walk(r,i))?r[i]=n:delete r[i]);return reviver.call(e,t,r)}if(cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,(function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("EBGVT.JSON.parse")})}(),EBG=EBG||{},EBG.DataProfile={GENERAL:"general",SERVING:"serving",OPTION:"option",ERROR:"error",FEATURE:"feature",DEBUG:"debug"},EBG.DataPipeSendMode={INSTANT:0,TIMEOUT:1,UNLOAD:2},EBG.DataPipe=function(e){this._profile=this._completeProfile,this._buckets={},this._startTime=e},EBG.DataPipe.prototype={_data:{general:{}},_unloadHandled:!1,_completeProfile:{general:{sendmode:!0,sid:!0,otsid:!0,tagid:!0,src:!0,inittime:!0,endtime:!1},serving:{total:!1,seccall:!1,pageurl:!1,sendtime:!1,restime:!1,retries:!1,timeout:!1,status:!1,cretries:!1,ctimeout:!1,cstatus:!1,malformed:!1,ua:!1},option:{ptcl:!1,sync:!1,inactive:!1,disptype:!1},error:{errnum:!1,errmsg:!1,errfunc:!1,errpos:!1,errstack:!1,errtype:!1},feature:{err:!0,errscript:!1,errdscript:!1,api:!1,tpbe:!1,gdpr:!1,pstclick:!1,uin:!1,szmkuin:!1,szmkuintime:!1,timeevt:!1,clickevt:!1},debug:{}},createBucket:function(e,t,i,n){var r=n||{};if(r.tickDelay=r.tickDelay||0,r.tickCount=0,r.tickTimes=r.tickTimes||0,this._buckets[e]={profile:t,url:i,options:r},r.sendOnUnload&&this.subscribeToEvent("unload",(function(){this._buckets[e].options._unloadHandled=!0,this.send(e,EBG.DataPipeSendMode.UNLOAD)})),r.tickDelay){var a=this,s=function(){var t=a._buckets[e];t.options._unloadHandled||(a.send(e,EBG.DataPipeSendMode.TIMEOUT),r.tickTimes&&++t.options.tickCount<t.options.tickTimes&&setTimeout(s,r.tickDelay))};setTimeout(s,r.tickDelay)}},isBucketExists:function(e){return!!this._buckets[e]},parseException:function(e){var t="none",i="none",n="none";if(e.stack){i=e.stack.replace(/\(.*\/|(ccfix)/g,"(").replace(/\n(\s)*/g," || ").substr(0,1e3);var r=e.stack.match(/((.*)@|at (.*) ).*:(\d+:\d+)/);5==r.length&&(n=r[2]||r[3],t=r[4])}return{errfunc:n,errstack:i,errpos:t,message:e.message}},_post:function(){if(navigator&&navigator.sendBeacon)return function(e,t){t&&t.sid&&navigator.sendBeacon(e,JSON.stringify(t))};var e={x:function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;for(var e,t=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],i=0;i<t.length;i++)try{e=new ActiveXObject(t[i]);break}catch(e){}return e},get:function(t,i,n){try{if(i&&i.sid){t=t+"?json="+JSON.stringify(i);var r=e.x();r.open("GET",t,n),r.send(null)}}catch(e){}},post:function(t,i,n){try{if(i&&i.sid){var r=e.x();r.open("POST",t,n),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.send(JSON.stringify(i))}}catch(e){}}};return window.mraid?e.get:e.post}(),log:function(e,t,i){if(2!==EBG.isTestMode&&!EBG.isPreview&&(i=i||{},this._profile[e]))for(var n in this._data[e]=this._data[e]||{},t)if(("debug"==e||n in this._profile[e])&&void 0!==t[n]){var r="";if(t[n]instanceof Array){for(var a=[],s=0;s<t[n].length;++s)a.push(encodeURIComponent(t[n][s]));r=a}else r=encodeURIComponent(t[n]);this._data[e][n]=r}},send:function(e,t){t=t||0;var i=this._buckets[e]||{},n=i.profile,r=i.url;if(r&&n){this._startTime&&(this._data.general.ctick=+new Date-this._startTime,this._data.general.sendmode=t);for(var a={},s=0;s<n.length;++s){var o=n[s];for(var c in this._data[o])a[c]=this._data[o][c]}this._post(r,a,!this._unloadHandled)}},subscribeToEvent:function(e,t){var i=this,n=function(e){t.apply(i,[e])};window.attachEvent?window.attachEvent("on"+e,n):window.addEventListener(e,n)}},EBG.DataPipeManager=function(e){this._startTime=e},EBG.DataPipeManager.prototype={_pipes:{},createPipe:function(e){var t=new EBG.DataPipe(this._startTime);t.log(EBG.DataProfile.GENERAL,{sid:e,dpv:3,src:"tm"}),this._pipes[e]=t},getPipe:function(e){return this._pipes[e]||this.createPipe(e),this._pipes[e]},log:function(e,t,i,n){var r=this._pipes[e];r&&r.log(t,i,n)}},EBG.Semi.EventName={ALL_USER_ID_FOUND:"allUserIdFound"},EBG.Semi.ServingState={script:"SCRIPT",friendlyIframe:"FRIENDLY_IFRAME",unfriendlyIframe:"IFRAME"},EBG.Semi.Events=EBG.Semi.Events||{},EBG.Semi.Events.EventManager=function(){},EBG.Semi.Events.EventManager.prototype={_subscriptions:{},subscribeToEvent:function(e,t,i,n){this._subscriptions[e]||(this._subscriptions[e]={}),this._subscriptions[e][n]||(this._subscriptions[e][n]=[]),n&&this._subscriptions[e][n].push({callback:t,bindingCallback:i})},dispatchEvent:function(e,t,i){if(i)for(var n=this._subscriptions[e][i],r=0;r<n.length;++r){(s=this._subscriptions[e][i][r]).callback.apply(s.bindingCallback,[t])}else{var a=this._subscriptions[e];for(var i in a)if(a[i])for(n=a[i],r=0;r<n.length;++r){var s;(s=a[i][r]).callback.apply(s.bindingCallback,[t])}}}},EBG.Semi.Events.eventMgr=EBG.Semi.Events.eventMgr||new EBG.Semi.Events.EventManager,EBG.Semi.WindowUtil=function(){},EBG.Semi.WindowUtil.getTopWindow=function(){var e=window,t=e.location.origin||e.location.protocol+"//"+e.location.host;e.EBservingMode=EBG.Semi.ServingState.script;try{if(window.location.ancestorOrigins&&window.URL)for(var i=0;i<location.ancestorOrigins.length;i++){if(0==i&&"null"==t&&(t=location.ancestorOrigins[0]),location.ancestorOrigins[i]!==t){e.EBservingMode=EBG.Semi.ServingState.unfriendlyIframe;break}(e=e.parent).EBservingMode=EBG.Semi.ServingState.friendlyIframe}else for(;e!==e.parent;){var n=null,r=e.location.origin||e.location.protocol+"//"+e.location.host;try{n=e.parent.location.origin||e.parent.location.protocol+"//"+e.parent.location.host}catch(e){}if(n!==r){e.EBservingMode=EBG.Semi.ServingState.unfriendlyIframe;break}(e=e.parent).EBservingMode=EBG.Semi.ServingState.friendlyIframe}}catch(e){}return e},EBG.Semi.BrowserDetector=function(){this.browserName=navigator.appName,this.fullVersion=""+parseFloat(navigator.appVersion),this.majorVersion=parseInt(navigator.appVersion,10),this._init()},EBG.Semi.BrowserDetector.Browser={InternetExplorer:"InternetExplorer",Chrome:"Chrome",Firefox:"Firefox",Opera:"Opera",Safari:"Safari"},EBG.Semi.BrowserDetector.prototype={_init:function(){var e,t,i,n=navigator.userAgent;-1!=(t=n.indexOf("Opera"))?(this.browserName=EBGVT.BrowserDetector.Browser.Opera,this.fullVersion=n.substring(t+6),-1!=(t=n.indexOf("Version"))&&(this.fullVersion=n.substring(t+8))):-1!=(t=n.indexOf("MSIE"))?(this.browserName=EBGVT.BrowserDetector.Browser.InternetExplorer,this.fullVersion=n.substring(t+5)):-1!=(t=n.indexOf("Chrome"))?(this.browserName=EBGVT.BrowserDetector.Browser.Chrome,this.fullVersion=n.substring(t+7)):-1!=(t=n.indexOf("Safari"))?(this.browserName=EBGVT.BrowserDetector.Browser.Safari,this.fullVersion=n.substring(t+7),-1!=(t=n.indexOf("Version"))&&(this.fullVersion=n.substring(t+8))):-1!=(t=n.indexOf("Firefox"))?(this.browserName=EBGVT.BrowserDetector.Browser.Firefox,this.fullVersion=n.substring(t+8)):(e=n.lastIndexOf(" ")+1)<(t=n.lastIndexOf("/"))&&(this.browserName=n.substring(e,t),this.fullVersion=n.substring(t+1),this.browserName.toLowerCase()==this.browserName.toUpperCase()&&(this.browserName=navigator.appName)),-1!=(i=this.fullVersion.indexOf(";"))&&(this.fullVersion=this.fullVersion.substring(0,i)),-1!=(i=this.fullVersion.indexOf(" "))&&(this.fullVersion=this.fullVersion.substring(0,i)),this.majorVersion=parseInt(""+this.fullVersion,10),isNaN(this.majorVersion)&&(this.fullVersion=""+parseFloat(navigator.appVersion),this.majorVersion=parseInt(navigator.appVersion,10))}},EBG=EBG||{},EBG.Adaptors=EBG.Adaptors||{},EBG.Adaptors.CMPDetector=function(e){var t=this;if(e=e||{timeout:300,accurateTimeout:0},window.__cmp&&"function"==typeof __cmp?this.exists=!0:this._detectCMPLocator(),!this.exists)return this._setReason(0),void this._setDefaultValue();setTimeout((function(){var i=arguments.callee;if(t.cmpCheckTimedout=!0,t._timeoutActualTime=(new Date).getTime()-t._startTime,e.accurateTimeout&&(e.accurateTimeout--,t._timeoutActualTime<e.timeout))return t._timeoutTimeGap||(t._timeoutTimeGap=e.timeout-t._timeoutActualTime),void setTimeout((function(){i.apply(t,[])}),Math.max(e.timeout-t._timeoutActualTime,1));void 0===t.consentData&&(t._setReason(-1),t._setDefaultValue(),t._publishConsentData())}),e.timeout),this._startTime=(new Date).getTime();try{!function(){var e=arguments.callee;__cmp("ping",null,(function(i,n){n&&i.cmpLoaded?(t.initialized=!0,t._getConsentData((function(e){t._time=(new Date).getTime()-t._startTime,void 0===this.consentData&&(e&&"number"==typeof e.gdprApplies&&(e.gdprApplies=e.gdprApplies+""),t.consentData=e,t._publishConsentData())}))):t.cmpCheckTimedout||setTimeout((function(){e.apply(t,[])}),5)}))}()}catch(e){t._setDefaultValue(),t._publishConsentData()}},EBG.Adaptors.CMPDetector.prototype={exists:!1,initialized:!1,subscriptions:[],_time:-1,_detectCMPLocator:function(){for(var e,t=window;!e;){try{t.frames.__cmpLocator&&(e=t)}catch(e){}if(t===window.top)break;t=t.parent}var i={};e&&(this.exists=!0,window.__cmp=function(t,n,r){var a=Math.random()+"",s={__cmpCall:{command:t,parameter:n,callId:a}};i[a]=r,e.postMessage(s,"*")},window.addEventListener("message",(function(e){try{var t="string"==typeof e.data?JSON.parse(e.data):e.data;if(t.__cmpReturn){var n=t.__cmpReturn;i[n.callId](n.returnValue,n.success),delete i[n.callId]}}catch(e){}}),!1))},_getConsentData:function(e){var t=this;try{!function(){var i=arguments.callee;t.exists&&t.initialized&&!t.cmpCheckTimedout?__cmp("getConsentData",null,(function(i,n){n?(t._setReason(1),e.apply(t,[i])):(t._setReason(2),e.apply(t,[null]))})):t.cmpCheckTimedout||setTimeout((function(){i.apply(t,[])}),5)}()}catch(e){}},getConsentData:function(e,t){void 0!==this.consentData?e.apply(t,[this.consentData]):this.subscriptions.push({callback:e,context:t||this})},_setDefaultValue:function(){this.initialized=!0,this.consentData=this.defaultConsentData},_publishConsentData:function(){if(void 0!==this.consentData){for(var e=0;e<this.subscriptions.length;e++){var t=this.subscriptions[e];try{t.callback.apply(t.context,[this.consentData])}catch(e){}}this.subscriptions=[]}},_setReason:function(e){void 0===this._reason&&(this._reason=e)},defaultConsentData:null},EBG=EBG||{},EBG.Adaptors=EBG.Adaptors||{},EBG.Adaptors.TCFDetector=function(e){this.init(e)},EBG.Adaptors.TCFDetector.prototype={exists:!1,initialized:!1,subscriptions:[],_time:-1,_timeoutActualTime:-1,__tcfapi:function(){window.__tcfapi.apply(window,arguments)},init:function(e){var t=this;if(e=e||{timeout:300,accurateTimeout:0},window.__tcfapi&&"function"==typeof window.__tcfapi?this.exists=!0:this._detectTCFLocator(),!this.exists)return this._setReason(0),void this._setDefaultValue();setTimeout((function(){var i=arguments.callee;if(t._timeoutActualTime=(new Date).getTime()-t._startTime,e.accurateTimeout&&(e.accurateTimeout--,t._timeoutActualTime<e.timeout))return t._timeoutTimeGap||(t._timeoutTimeGap=e.timeout-t._timeoutActualTime),void setTimeout((function(){i.apply(t,[])}),Math.max(e.timeout-t._timeoutActualTime,1));t.cmpCheckTimedout=!0,void 0===t.consentData&&(t._setReason(-1),t._setDefaultValue(),t._publishConsentData())}),e.timeout),this._startTime=(new Date).getTime();try{!function(){var e=arguments.callee;t.__tcfapi("ping",2,(function(i,n){(void 0===n||n)&&i&&i.cmpLoaded?(t.initialized=!0,t._getConsentData((function(e){t.handleConsentReceived(e)}))):t.cmpCheckTimedout||setTimeout((function(){e.apply(t,[])}),5)}))}()}catch(e){t._setDefaultValue(),t._publishConsentData()}},_detectTCFLocator:function(){for(var e,t=window,i={};t;){try{if(t.frames.__tcfapiLocator){e=t;break}}catch(e){}if(t===window.top)break;t=t.parent}if(e){this.exists=!0,this.__tcfapi=function(t,n,r,a){if(e){var s=Math.random()+"",o={__tcfapiCall:{command:t,parameter:a,version:n,callId:s}};i[s]=r,e.postMessage(o,"*");var c=setInterval((function(){i[s]?e.postMessage(o,"*"):clearInterval(c)}),20)}else r({msg:"CMP not found"},!1)},window.addEventListener("message",(function(e){var t={};try{t="string"==typeof e.data?JSON.parse(e.data):e.data}catch(e){}var n=t.__tcfapiReturn;n&&"function"==typeof i[n.callId]&&(i[n.callId](n.returnValue,n.success),i[n.callId]=null)}),!1)}},handleConsentReceived:function(e){this._time=(new Date).getTime()-this._startTime,void 0===this.consentData&&(e&&"number"==typeof e.gdprApplies&&(e.gdprApplies=e.gdprApplies+""),this.consentData={gdprApplies:e.gdprApplies,consentData:e.tcString},this._publishConsentData())},_getConsentData:function(e){var t=this,i=!1,n=function(n){i||(i=!0,t._setReason(1),e.apply(t,[n]))};try{!function(){t.exists&&t.initialized&&!t.cmpCheckTimedout&&(t.__tcfapi("addEventListener",2,(function(e,i){i&&e.tcString&&("tcloaded"==e.eventStatus||"useractioncomplete"==e.eventStatus)&&(n(e),e.listenerId&&t.__tcfapi("removeEventListener",2,(function(){}),e.listenerId))})),function(){var e=arguments.callee;try{t.__tcfapi("getTCData",2,(function(i,r){r&&i.tcString?n(i):t.cmpCheckTimedout||setTimeout((function(){e.apply(t,[])}),5)}))}catch(i){t.cmpCheckTimedout||setTimeout((function(){e.apply(t,[])}),5)}}())}()}catch(i){t._setReason(2),e.apply(t,[null])}},getConsentData:function(e,t){void 0!==this.consentData?e.apply(t,[this.consentData]):this.subscriptions.push({callback:e,context:t||this})},_setDefaultValue:function(){this.initialized=!0,this.consentData=this.defaultConsentData},_publishConsentData:function(){if(void 0!==this.consentData){for(var e=0;e<this.subscriptions.length;e++){var t=this.subscriptions[e];try{t.callback.apply(t.context,[this.consentData])}catch(e){}}this.subscriptions=[]}},_setReason:function(e){void 0===this._reason&&(this._reason=e)},defaultConsentData:null},EBG.Semi.declareNamespace("Logging"),EBG.Semi.Logging.Logger=function(e){this._level=e,this.startNestingGroupNames=[],this.endNestingGroupNames=[]},EBG.Semi.Logging.Logger.DebugMode="mmdebug",EBG.Semi.Logging.Logger.LoggerLevels={NONE:0,ERROR:1,INFO:2,WARN:3,DEBUG:4},EBG.Semi.Logging.Logger.prototype={setLevel:function(e){this._level=e},timestamp:!1,debug:function(e){this._reportToLog(EBG.Semi.Logging.Logger.LoggerLevels.DEBUG,arguments)},info:function(e){this._reportToLog(EBG.Semi.Logging.Logger.LoggerLevels.INFO,arguments)},warn:function(e){this._reportToLog(EBG.Semi.Logging.Logger.LoggerLevels.WARN,arguments)},error:function(e){this._reportToLog(EBG.Semi.Logging.Logger.LoggerLevels.ERROR,arguments)},exception:function(e,t){var i="string"!==t?this._format("Exception in {0}. message: {1}",e,t.message):this._format("Exception in: {0}. message: {1}",e,t);t.stack&&(i+=this._format(" stack: {0}",t.stack)),this._reportToLog(EBG.Semi.Logging.Logger.LoggerLevels.ERROR,[i])},startGroup:function(e){this._supportNesting()&&this.startNestingGroupNames.push(e)},endGroup:function(){this._supportNesting()&&this.endNestingGroupNames.length>0&&window.console.groupEnd(this.endNestingGroupNames.pop())},_consoleAvailable:function(){try{return void 0!==window&&void 0!==window.console}catch(e){return!1}},_supportNesting:function(){return!!this._consoleAvailable()&&void 0!==window.console.group},_supportErrorMessage:function(){return void 0!==window.console.error},_supportInfoMessage:function(){return void 0!==window.console.info||void 0!==window.opera},_supportWarnMessage:function(){return void 0!==window.console.warn||void 0!==window.opera},_supportObjectView:function(){return void 0!==window.console.dir||void 0!==window.opera},_callConsoleFunction:function(e,t){var i=!1;switch(e){case EBG.Semi.Logging.Logger.LoggerLevels.INFO:this._supportInfoMessage()&&(window.console.info(t),i=!0);break;case EBG.Semi.Logging.Logger.LoggerLevels.WARN:this._supportWarnMessage()&&(window.console.warn(t),i=!0);break;case EBG.Semi.Logging.Logger.LoggerLevels.ERROR:this._supportErrorMessage()&&(consoleFunction=window.console.error(t),i=!0)}i||window.console.log(t)},_format:function(e){for(var t=1;t<arguments.length;t++)e=e.replace(new RegExp("\\{"+(t-1)+"\\}","gi"),""+arguments[t]);return e},_getTimestamp:function(){if(this.timestamp)return EBG.Semi.Infra.getTimestamp()},_reportToLog:function(e,t){if(this._level>=e&&this._consoleAvailable()){var i=t[0];if("[object String]"!==Object.prototype.toString.call(i)?this._supportObjectView()||(i=i.toString()):i=this._format.apply(null,t),this.timestamp&&"[object String]"===Object.prototype.toString.call(i)&&(i=this._getTimestamp()+": "+i),void 0===window.opera){for(;this.startNestingGroupNames.length;)window.console.group(this.startNestingGroupNames[0]),this.endNestingGroupNames.push(this.startNestingGroupNames.shift());this._callConsoleFunction(e,i)}else opera.postError(i)}}},EBG.Semi.ServerCommunicator=function(){for(this._imgArr=[],this._requestCounter=0,this._throttlingHandler=null,this._throttlingTimeout=1e3,this._throttlingMax=10,i=0;i<10;i++)this._imgArr.push(new Image)},EBG.Semi.ServerCommunicator.prototype={_timeout:0,_retries:-1,sendRequest:function(e,t,i,n){var r=this,a=r._retries,s=function(e,r,s){r&&r.status>=200&&r.status<400?t&&t.apply(n||this,[e,r]):(i&&i.apply(n||this,[a,s,r]),a>0&&(a--,setTimeout(o,1e3*Math.pow(2,a))))},o=function(){r._throttlingHandler||(r._throttlingHandler=setTimeout((function(){clearTimeout(r._throttlingHandler),r._throttlingHandler=null,r._requestCounter=0}),r._throttlingTimeout)),r._requestCounter>r._throttlingMax?setTimeout((function(){o()}),r._throttlingTimeout/2):(r._requestCounter++,EBG.Semi.Infra.ajax.get(e,{},s,!0,{timeout:r._timeout}))};o()},reportUrlsList:function(e,t,i){for(var n=0;n<this._imgArr.length;n++)this.reportUrl(e,this._imgArr[n],t,i)},reportUrl:function(e,t,i,n){if(e.length>0){var r=this;a=e.shift(),t.onload=function(){i&&n&&setTimeout((function(){i.apply(n,[null,a])}),1),r.reportUrl(e,t,i,n)},t.onerror=function(){i&&n&&setTimeout((function(){i.apply(n,["failed loading url",a])}),1),r.reportUrl(e,t,i,n)},t.src=a}var a}},EBGVT.RuleManager=function(e,t,i,n,r){EBGVT.Light.Infra.isDefined(e)&&(this.versaTagObj=r,this._sessionId=t,this._diAppId=i||-1,this._usercookie=n||"",this._buildRulesArray(e))},EBGVT.RuleManager.prototype={_rules:[],_rulesHitted:[],_buildRulesArray:function(e){for(var t in e)this._rules.push(new EBGVT.Rule(e[t],{binding:this,func:this._onRuleHit}))},_onRuleHit:function(e){if(this.versaTagObj){-1==EBGVT.Light.Infra.indexOfArray(this._rulesHitted,e)&&this._rulesHitted.push(e),this._timeoutHandler&&clearTimeout(this._timeoutHandler);var t=this;this._timeoutHandler=setTimeout((function(){t.versaTagObj.generateRequest(null,{sessionId:t._sessionId,browserEvent:t._rulesHitted,diAppId:t._diAppId,usercookie:t._usercookie},!0),t._rulesHitted=[]}),1)}}},EBGVT.Events=EBGVT.Events||{},EBGVT.Rule=function(e,t){this._id=e.id,this._callback=t,this._createEvents(e),this._conditions=e.conditions||this._getDefaultConditionString()},EBGVT.Rule.prototype={_createEvents:function(e){this._events={};var t=new RegExp("e[0-9]","i");for(var i in e)if(e.hasOwnProperty(i)&&t.test(i))try{EBGVT.Events[e[i].type]&&(this._events[i]=new EBGVT.Events[e[i].type](i,e[i].data,{func:this._eventMatchHandler,binding:this}))}catch(e){}},_getDefaultConditionString:function(){var e=[];for(var t in this._events)e.push(t);return"("+e.join("|")+")"},_eventMatchHandler:function(){this._checkRuleHit(this._conditions)&&this._callback.func.apply(this._callback.binding,[this._id]),this._resetEventStatus()},_resetEventStatus:function(){for(var e in this._events)this._events[e].reset()},_checkRuleHit:function(e){try{for(var t=this._breakConditionString(e),i=0;i<t.length;i++){if(!this._evaluateGroup(t[i]))return!1}return!0}catch(e){return!1}},_evaluateGroup:function(e){for(var t=0;t<e.length;t++){if(this._evaluateEvent(e[t]))return!0}return!1},_evaluateEvent:function(e){var t=this._events[e];return 1*(t&&t.applied)},_breakConditionString:function(e){for(var t=e.split("&"),i=0;i<t.length;i++){var n=t[i];t[i]=n.substr(1,n.length-2).split("|")}return t}},EBGVT.Events.ElementEvent=function(e,t,i){(EBGVT.Light.Infra.isDefined(t)||EBGVT.Light.Infra.isDefined(i))&&this.init(e,t,i)},EBGVT.Events.ElementEvent.prototype={applied:!1,init:function(e,t,i){var n=this;this._wins=this._getWindowsArray();var r=decodeURIComponent(t.selector),a=this._select(r);if("loading"!=document.readyState&&a.length){this._id=e,this._callback=i;for(var s=0;s<a.length;s++)EBGVT.Light.Infra.addEventListener(a[s],t.eventName,(function(e){n.onEvent(e)}))}else setTimeout((function(){n.init(e,t,i)}),100)},onEvent:function(){this.applied=!0,this._callback.func.apply(this._callback.binding,[this._id])},_select:function(e){for(var t=[],i=0;i<this._wins.length;i++){var n=this._wins[i].document.querySelectorAll(e);if(n)for(var r=0;r<n.length;r++)t.push(n[r])}return t},_getWindowsArray:function(){for(var e=window,t=[e];e!==e.parent&&e.self!==e.parent;){try{if(!e.parent.document.domain)return t;e=e.parent,t.push(e)}catch(e){return t}}return t},reset:function(){this.applied=!1}},EBGVT.Events.TimeEvent=function(e,t,i){(EBGVT.Light.Infra.isDefined(t)||EBGVT.Light.Infra.isDefined(i))&&this.init(e,t,i)},EBGVT.Events.TimeEvent.prototype={applied:!1,init:function(e,t,i){this._id=e,this._callback=i,this._startCounting(t)},_startCounting:function(e){var t=this;e&&(t._handler=setTimeout((function(){t.onEvent()}),e.threshold))},onEvent:function(){this.applied=!0,this._callback.func.apply(this._callback.binding,[this._id])},_handler:null,reset:function(){}},EBGVT.OTTAgent=function(){this.isActive()&&this.subsribe()},EBGVT.OTTAgent.prototype={pendingMessages:[],handleExtensionData:function(e,t,i,n){this.isActive()&&t&&(t.sendTime=n,t.receiveTime=i,t.tagManagerId=e,this.sendToTool("parseServerResponse",{data:t}))},initialize:function(){this.isInitialized=!0;for(var e=this.pendingMessages||[],t=0;t<e.length;t++)this.sendToTool.apply(this,e[t])},subsribe:function(){var e=this;this.pm.bind("BackgroundServiceResponse",(function(t){t&&t.data&&"setDataCollectionOption"==t.command&&(e.initialize(),e.dataCollectionOption=~~t.data.dataCollectionOption)}),this)},isActive:function(){var e=void 0;try{var t=document.querySelector("#ott_flag")||top.frames.ott_flag;e=!!t}catch(e){}return function(){return e}}(),sendToTool:function(e,t,i){if(i||this.isInitialized){(t=t||{}).command=e;var n=this.getOneTagTestToolIframe();n&&this.pm({type:e,target:n.contentWindow,data:t})}else this.pendingMessages.push(arguments)},getOneTagTestToolIframe:function(){return document.getElementById("szmk_ott")},send:function(e,t){this.isActive()&&(t.category=e,this.sendToTool("addRows",{category:e,data:t}))},getDataCollectionOption:function(){return this.dataCollectionOption},pm:function(e,t,i){var n={};return function(t,i,n){i.extend=function(){for(var e=arguments[0],t=1,i=arguments.length;i>t;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e},i.pm=function(e){r.send(e)},i.pm.bind=function(e,t,i,n,a){r.bind(e,t,i,n,a)},i.pm.unbind=function(e,t){r.unbind(e,t)},i.pm.dispatch=function(e,t,i,n){r._dispatch({data:JSON.stringify({data:t,type:e}),source:i,target:n,origin:null})},i.pm.origin=null;var r={send:function(e){var t=i.extend({},r.defaults,e),n=t.target;if(t.target&&t.type){var a={data:t.data,type:t.type};t.success&&(a.callback=r._callback(t.success)),t.error&&(a.errback=r._callback(t.error)),"postMessage"in n&&!t.hash&&(r._bind(),n.postMessage(JSON.stringify(a),t.origin||"*"))}},bind:function(t,n,a,s,o,c){if("postMessage"in e&&!c){r._bind(s||e);var u=r.data("listeners.postmessage");u||(u={},r.data("listeners.postmessage",u));var l=u[t];l||(l=[],u[t]=l),l.push({fn:n,origin:o||i.pm.origin,bindObj:a})}},unbind:function(e,t){var i=r.data("listeners.postmessage");if(i)if(e)if(t){var n=i[e];if(n){for(var a=[],s=0,o=n.length;o>s;s++){var c=n[s];c.fn!==t&&a.push(c)}i[e]=a}}else delete i[e];else i={}},data:function(e,t){return undefined===t?r._data[e]:(r._data[e]=t,t)},_data:{},_CHARS:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),_random:function(){for(var e=[],t=0;32>t;t++)e[t]=r._CHARS[0|32*Math.random()];return e.join("")},_callback:function(e){var t=r.data("callbacks.postmessage");t||(t={},r.data("callbacks.postmessage",t));var i=r._random();return t[i]=e,i},_bind:function(e){r.data("listening.postmessage")||((e=e||t).addEventListener?e.addEventListener("message",r._dispatch,!1):t.attachEvent&&e.attachEvent("onmessage",r._dispatch),r.data("listening.postmessage",1))},_dispatch:function(e){var t={};try{t=JSON.parse(e.data)}catch(e){return}if(t.type){var i=(r.data("callbacks.postmessage")||{})[t.type];if(i)i(t.data);else for(var n=(r.data("listeners.postmessage")||{})[t.type]||[],a=0,s=n.length;s>a;a++){var o=n[a];if(o.origin&&e.origin!==o.origin){if(t.errback){var c={message:"postmessage origin mismatch",origin:[e.origin,o.origin]};r.send({target:e.source,data:c,type:t.errback})}}else try{var u;u=o.bindObj?o.fn.apply(o.bindObj,[t.data,e]):o.fn(t.data,e),t.callback&&r.send({target:e.source,data:u,type:t.callback})}catch(i){t.errback&&r.send({target:e.source,data:i,type:t.errback})}}}}};i.extend(r,{defaults:{target:null,url:null,type:null,data:null,success:null,error:null,origin:"*",hash:!1}})}(this,n),n.pm}(window)},EBGUIP="undefined"!=typeof EBGUIP?EBGUIP:{},EBGUIP.Events=EBGUIP.Events||{},EBGUIP.Events.EventName={USER_ID_FOUND:"userIdFound",DOC_LOADED:"documentLoaded",EBUID_LOADED:"ebuidLoaded"},EBGUIP.Events.eventMgr=EBGUIP.Events.eventMgr||new EBG.Semi.Events.EventManager,EBGUIP="undefined"!=typeof EBGUIP?EBGUIP:{},EBGUIP.UserIdProvider=function(){"undefined"!=typeof gEBMainWindow&&gEBMainWindow.providersData?this._providersData=gEBMainWindow.providersData:"undefined"!=typeof gEBMainWindow&&(this._providersData={EBUidCache:{data:null,providerCalled:!1}},gEBMainWindow.providersData=this._providersData)},EBGUIP.ProvidersReversed={e2:"EBUidCache"},EBGUIP.UserIdProvider.prototype={_filter:null,_currTagData:null,_arrProvidersNamesUsed:null,_providers:{EBUidCache:{isUsed:!1,shouldSendData:!0}},_providersData:null,getUserIds:function(e){this._filter=e.filter,this._init(),this._currTagData=e,this._currTagData.currDoc||(this._currTagData.currDoc=document),this._arrProvidersNamesUsed=this._getValidProviderNames(e.uip);for(var t=0;t<this._arrProvidersNamesUsed.length;t++)this._providers[this._arrProvidersNamesUsed[t]].isUsed=!0;this._loadProviders()},_init:function(){for(var e in this._providers)this._providers[e].isUsed=!1},_loadProviders:function(){if(this._arrProvidersNamesUsed.length>0){var e=this._arrProvidersNamesUsed[0];if(this._providersData[e].providerCalled){var t={providerName:e};this._getUserIdentification(t)}else{EBGUIP.Events.eventMgr.subscribeToEvent(EBGUIP.Events.EventName.USER_ID_FOUND,this._getUserIdentification,this,this._filter);var i=this._buildProviderURL(e);this._currTagData.isSync?(EBGUIP.Events.eventMgr.subscribeToEvent(EBGUIP.Events.EventName.DOC_LOADED,this._providerLoaded,this,this._filter),EBG.Semi.Infra.loadFileByScriptElem(this._currTagData.currDoc,i,null,!0)):EBG.Semi.Infra.loadFileByScriptElem(this._currTagData.currDoc,i,this._providerLoaded,!1,this,{providerName:e})}}},_buildProviderURL:function(e){var t=this._currTagData.scriptsPath+"UserProviders"+this._currTagData.uipv+"/"+e+".js";return-1==this._currTagData.scriptsPath.indexOf("http")&&(t=this._getRequestProtocol(this._currTagData.ebPtcl)+t),t},_getRequestProtocol:function(e){if(e)return e;var t="https://secure-",i=location.protocol;if("javascript:"==i)try{i=parent.location.protocol}catch(e){}return"http:"==i&&(t=i+"//"),t},_providerLoaded:function(e){var t=e.providerName;-1!=EBG.Semi.Infra.indexOfArray(this._arrProvidersNamesUsed,t)&&(new window.EBGUIP[t]).init(this._currTagData)},_getUserIdentification:function(e){var t=EBG.Semi.Infra.indexOfArray(this._arrProvidersNamesUsed,e.providerName);if(-1!=t)if(e.tokenName&&e.id&&this._providers[e.providerName].shouldSendData&&!this._providersData[e.providerName].data&&(this._providersData[e.providerName].data="&"+e.tokenName+"="+e.id),this._providersData[e.providerName].providerCalled=!0,this._arrProvidersNamesUsed.splice(t,1),0==this._arrProvidersNamesUsed.length){var i={userIdStr:this._getProvidersData()};EBG.Semi.Events.eventMgr.dispatchEvent(EBG.Semi.EventName.ALL_USER_ID_FOUND,i,this._filter)}else this._loadProviders()},_getProvidersData:function(){var e="";for(var t in this._providersData)this._providers[t].isUsed&&this._providers[t].shouldSendData&&(e+=this._providersData[t].data);return e},_getValidProviderNames:function(e){for(var t=this._cleanUIPList(e),i=[],n=0;n<t.length;n++){var r=EBGUIP.ProvidersReversed["e"+t[n]];r&&(i[i.length]=r)}return i},_cleanUIPList:function(e){var t=[];if(e)for(var i=0;i<e.length;++i)EBGUIP.ProvidersReversed["e"+e[i]]&&t.push(e[i]);return t}},EBG.Semi.AttributionEnum=function(){},EBG.Semi.AttributionEnum.UrlParamNames={ID:"onetagid",DISP_TYPE:"dispType",SYNC:"sync",ONETAG_URL:"ebOneTagURL",PAGE_URL:"pageurl",DEBUG_MODE:"debugmode",NO_SCRIPT:"ns",MOBILE:"mb",ACTIVITY_PARAMS:"activityValues",RETARGET_PARAMS:"retargetingValues",DYNAMIC_RETARGET_PARAMS:"dynamicRetargetingValues",CONDITIONAL_PARAMS:"acp",RANDOM:"rnd",SEC_CALL:"secCall",SESSION_ID:"sessionid",ORIG_URL_LENGTH:"origLength",SERVING_PIPE:"/Serving",PREV_SERVING_PIPE:"/BurstingPipe",BROWSER_EVENT:"tp_be",ADV_DEVICE_ID:"ebaddid",DI_APP_ID:"diappid",USER_COOKIE:"usercookie",POST_CLICK:"pstclk",UIN:"uinadv",OPTOUT:"optout"},EBG.Semi.AttributionEnum.DisplayTypes={IFRAME:"iframe",JAVASCRIPT:"js"},EBG.Semi.AttributionEnum.HttpProtocol={HTTP:"http",HTTPS:"https"},EBGVT="undefined"!=typeof EBGVT?EBGVT:{},EBGVT.Light=EBGVT.Light||{},EBGVT.Light.Infra=EBG.Semi.Infra,EBGVT.Light.Logger=EBG.Semi.Logging.Logger,EBGVT.EBGUIP=EBGUIP,EBGVT.OneTagLogger=function(){},EBGVT.OneTag=function(e){this.inittime=(new Date).getTime(),e&&e.$&&(this._onready=e.$),this._initDataPipe(),this.dp.log(EBG.DataProfile.GENERAL,{inittime:this.inittime});try{this._scriptElement=EBG.Semi.Infra.getCurrentScriptElement(),this._scriptElement&&this._scriptElement.options&&(this.options=this._scriptElement.options),this.tagid=this.options&&this.options.id||window.versaTag&&window.versaTag.id,this.sessionId=this.getSessionId(),this.dp.log(EBG.DataProfile.GENERAL,{otsid:this.sessionId,tagid:this.tagid||"none"}),this.dp.log(EBG.DataProfile.SERVING,{ua:navigator.userAgent});var t=this.getSZMKUin();t&&t.id&&t.time&&this.dp.log(EBG.DataProfile.FEATURE,{szmkuin:t.id,szmkuintime:t.time}),this.logNeeded=EBGVT.Light.Infra.getUrlParameter(EBGVT.Light.Logger.DebugMode)?1:0,this.oneTagLogger=new EBGVT.Light.Logger(EBGVT.Light.Infra.getUrlParameter(EBGVT.Light.Logger.DebugMode)),this.uidProviders=new EBGVT.EBGUIP.UserIdProvider,this.oneTagLogger.timestamp=!0,this.ott=new EBGVT.OTTAgent,this.serverCommunicator=this.serverCommunicator||new EBG.Semi.ServerCommunicator;var i=new EBG.Adaptors.TCFDetector,n=new EBG.Adaptors.CMPDetector;this.gdprDetector=i.exists?i:n,this.pageUrl=null,this._init()}catch(e){this._handleUnhandledError(e)}},EBGVT.OneTag.prototype={_userIdProvidersCalled:!1,_providers:null,_onpreready:[],_onready:[],isReady:!1,_scriptElement:null,_responseCount:0,_isHandlingRequest:!1,_totalRequests:0,_totalResponses:0,_handleUnhandledError:function(e,t){try{this.dp.log(EBG.DataProfile.SERVING,{pageurl:EBGVT.Light.Infra.getWindowLocation().href})}catch(e){}this.dp.log(EBG.DataProfile.GENERAL,{tagid:this.tagid||"none"});var i=this.dp.parseException(e);this.dp.log(EBG.DataProfile.ERROR,{errmsg:i.message,errfunc:i.errfunc,errpos:i.errpos,errstack:i.errstack,errtype:t||0}),this.dp.send("tme",EBG.DataPipeSendMode.INSTANT),this.dp.log(EBG.DataProfile.FEATURE,{err:1})},_init:function(){this._getServerConfiguration((function(e){if(e&&!e.empty)this._oneTagObj=e;else if(window.versaTag){window.versaTag.sync=0,window.versaTag.ptcl="https",this._oneTagObj=window.versaTag,this._oneTagObj.uin=this._getDataLayerProperty("SizmekDataLayer","uin");var t=this._getDataLayerProperty("SizmekDataLayer","optout");EBGVT.Light.Infra.isDefined(t)&&(this._oneTagObj.optout=~~t)}else this.options&&this.options.id&&(window.versaTag={},versaTag.id=this.options.id,versaTag.sync=0,versaTag.dispType="js",versaTag.ptcl="https",versaTag.bsUrl=this.options.bsUrl||"bs.serving-sys.com/Serving",this._oneTagObj=window.versaTag);if(this._oneTagObj){e=this._oneTagObj;this.dp.log(EBG.DataProfile.OPTION,{disptype:e.dispType,ptcl:e.ptcl,sync:e.sync,inactive:e.inactive}),this.onready(this.options&&this.options.onready),this._ready()}}))},_initDataPipe:function(){var e=this._extractDomainFromOneTagScript(),t="https://lm"+(e=e.substr(e.indexOf(".")))+"/lm/tme",i="https://lm"+e+"/lm/tmd",n=new EBG.DataPipeManager(+new Date).getPipe(this.generateSessionId());n.isBucketExists("tme")||n.createBucket("tme",["general","serving","option","error"],t),n.isBucketExists("tmd")||n.createBucket("tmd",["general","serving","option","feature"],i,{tickTimes:1,tickDelay:3e4,sendOnUnload:!0}),this._handleAPIExceptions(),this.dp=n},_handleAPIExceptions:function(){for(var e in $this=this,this)e&&this.hasOwnProperty(e)&&"_"==!e.indexOf(0)&&function(e){var t=$this[e];$this[e]=function(){try{t.apply($this,arguments)}catch(e){this._handleUnhandledError(e,2)}}}(e)},_getServerConfiguration:function(e){var t,i=this;try{t=this._getConfigurationPath()}catch(t){return void e.apply(i,[null,t])}this.serverCommunicator.sendRequest(t,(function(t,n){try{i.dp.log(EBG.DataProfile.SERVING,{cstatus:n.status});var r=JSON.parse(t);r.developerScripts&&r.developerScripts.preScript?i._runDeveloperScript(r.developerScripts.preScript,(function(){e.apply(i,[i._parseConfig(r)])})):e.apply(i,[i._parseConfig(r)])}catch(t){i.dp.log(EBG.DataProfile.FEATURE,{errdscript:1}),i._handleUnhandledError(t),e.apply(i,[null,t])}}),(function(t,n,r){i.dp.log(EBG.DataProfile.SERVING,{cretries:t,cstatus:r.status,ctimeout:~~n}),t<=0&&e.apply(i,[null,new Error("Unable to get configuration file")])}),!0)},_parseConfig:function(e){var t={};if(e.empty)return e;for(var i in e)"parameters"!==i&&(t[i]=e[i]);var n=this.options||{};if(t.id=n.id||window.versaTag&&versaTag.id||"unknown",t.sync=0,t.dispType=n.dispType||e.dispType||"js",t.bsUrl=n.bsUrl||e.bsUrl||"bs.serving-sys.com/Serving",t.ptcl="https",t.advertiserDeviceId=n.advertiserDeviceId,t.inactive=e.inactive,e&&e.parameters){if(n.parameters)for(var r in n.parameters){var a=n.parameters[r];e.parameters[r]=e.parameters[r]||[];for(var s=this._getFieldsFromGroup(e.parameters[r]),o=0;o<a.length;o++){var c=a[o],u=this._getObjField(c),l=s.indexOf(u);-1==l?e.parameters[r].push(c):e.parameters[r][l]=c}}var d=e.parameters;if(e.parameters.dataLayer=n.dataLayer||e.parameters.dataLayer,this.options&&(this.options.dataLayer=e.parameters.dataLayer),t.dataLayer=e.parameters.dataLayer,t.activityParams=this._parameterParse(d.conversion,"conversion",e.parameters.dataLayer),t.dynamicRetargetParams=this._parameterParse(d.retargeting,"retargeting",e.parameters.dataLayer),t.conditionalParams=this._parameterParse(d.conditional,"conditional",e.parameters.dataLayer),window.versaTag){var p=["activityParams","dynamicRetargetParams","conditionalParams"];for(o=0;o<p.length;o++){if(r=versaTag[p[o]])for(var i in r)EBGVT.Light.Infra.isDefinedNotNull(r[i])&&!EBGVT.Light.Infra.isDefined(t[p[o]][i])&&(t[p[o]][i]=r[i])}}}var g=n.uparam||e.uparam;t.uin=g?this._parameterParse(g,"uin",t.dataLayer||"SizmekDataLayer"):this._getDataLayerProperty(e.parameters.dataLayer||"SizmekDataLayer","uin"),"object"!=typeof t.uin&&(t.uin={defaultkeyname:t.uin});var f=this._getDataLayerProperty(t.dataLayer||"SizmekDataLayer","optout");return EBGVT.Light.Infra.isDefined(f)&&(t.optout=~~f),t},_getDataLayerProperty:function(e,t){return window[e]&&window[e][t]},_getFieldsFromGroup:function(e){for(var t=[],i=0;i<e.length;i++)for(var n in e[i])t.push(n);return t},_getObjField:function(e){if(!e)return null;for(var t in e)return t},_parameterParse:function(e,t,i){var n={};if(!e)return n;"object"==EBG.Semi.Infra.typeOf(e)&&(e=[e]);for(var r=0;r<e.length;r++){var a=e[r];for(var s in a){var o=this._getValue(s,a[s],t,i);EBGVT.Light.Infra.isDefinedNotNull(o)&&(n[s]=o)}}return n},_getValue:function(e,t,i,n){var r;"object"==EBG.Semi.Infra.typeOf(t)&&(t=[t]);for(var a=0;a<t.length;a++){switch((s=t[a]).type){case"JS":r=EBG.Semi.Infra.getValueFromPath(s.path);break;case"QS":r=EBG.Semi.Infra.getQuerystringParam(s.key||s.path);break;case"DL":n&&s.path&&(r=EBG.Semi.Infra.getValueFromPath(n+"."+s.path));break;case"CONST":r=s.value}if(EBGVT.Light.Infra.isDefinedNotNull(r)&&""!=r)return this.ott.send("variables",{category:i,variableName:e,type:s.type,path:s.path,value:r}),r}for(a=t.length-1;a>=0;a--){var s;if((s=t[a]).def)return this.ott.send("variables",{type:s.type,path:s.path,value:s.def+" (default)"}),s.def}return null},_getConfigurationPath:function(){var e=this._extractDomainFromOneTagScript(),t=this.tagid;return 0!=e.indexOf("ds.serving-sys.com")&&0!=e.indexOf("ds.serving-sys-int.com")||(e="secure-"+e),"https://"+e+"/adServingData/"+this._getEnv(e)+"/TMClient/"+t.substr(t.length-1,1)+"/"+t},_extractDomainFromOneTagScript:function(){var e=this._getOneTagScript();if(!e||!e.src)return"ds.serving-sys.com";var t=e.src;return(t.indexOf("//")>-1?t.split("/")[2]:t.split("/")[0]).split(":")[0].split("?")[0]},_getEnv:function(e){if(!e)return"";switch(e.toLowerCase().replace("secure-","")){case"ds.serving-sys-dev4.com":return"DEV4";case"ds.serving-sys-int.com":return"UAT";default:return"PROD"}},onready:function(e,t){if(e)if(this.isReady)try{e.apply(this)}catch(e){}else t?this._onpreready.push(e):this._onready.push(e)},_ready:function(){if(!this.isReady){this.isReady=!0;for(var e=0;e<this._onpreready.length;e++)this._onready.unshift(this._onpreready[e]);for(e=0;e<this._onready.length;e++)try{this._onready[e].apply(this)}catch(e){}}},getQuerystringConfiguration:function(e){try{for(var t=e.src.split("?")[1],i={},n=t.split("&"),r=0;r<n.length;r++){var a=n[r].split("=");i[a[0]]=a[1]}return i.dispType=i.dispType||"js",i.sync=0,i}catch(e){return null}},generateRequest:function(e,t,i){var n=this;if(this.ott.isActive()&&this.ott.sendToTool("oneTagFound",{},!0),this.ott.isActive()&&null==this.ott.getDataCollectionOption()){this.ott.sendToTool("requestDataCollectionOption",{},!0);n=this;setTimeout((function(){n.generateRequest(e,t,i)}),100)}else if(!this._oneTagObj||!this._oneTagObj.inactive)if(this._isHandlingRequest){n=this;setTimeout((function(){n.generateRequest(e,t,i)}),100)}else if(this._isHandlingRequest=!0,this._oneTagObj){this.oneTagLogger.info("One Tag Started"),this.pageUrl=this._oneTagObj.overridePageUrl||e,t&&t.firstPartyServingDomain&&(this._oneTagObj.bsUrl=t.firstPartyServingDomain+EBG.Semi.AttributionEnum.UrlParamNames.SERVING_PIPE);var r=this._oneTagObj.id,a=t&&t.sessionId?t.sessionId:this.generateSessionId();this._oneTagObj.sessionId=a;var s=t&&t.browserEvent?"$$"+t.browserEvent.join("&")+"$$":"",o=t&&EBGVT.Light.Infra.isDefined(t.diAppId)?t.diAppId:-1,c=t&&EBGVT.Light.Infra.isDefined(t.usercookie)?t.usercookie:"",u=this._generateBsURL(this._oneTagObj,this.pageUrl,i,a,s,o,c);this.gdprDetector.getConsentData((function(e){this.consentData=e,u=this._addGdprConsent(u,e),this.oneTagLogger.info("Server URL: "+u),t&&t.preServingTasks&&t.preServingTasks.length>0&&this._userIdProvidersCalled&&(u=this._addProviderUserId(u,t)),this.fireRequest(r,a,u)}),this)}else if(e)this._isHandlingRequest=!1,versaTagObj.onready((function(){this.generateRequest(e,t,i)}));else if(t&&i){u=document.location.href;if(t&&t.firstPartyServingDomain){var l=document.domain,d=l+location.pathname;l&&l.length>0&&(u=u.indexOf(d)>0?u.replace(d,t.firstPartyServingDomain+EBG.Semi.AttributionEnum.UrlParamNames.SERVING_PIPE):u.replace(l,t.firstPartyServingDomain))}u=(u=u.replace(EBG.Semi.AttributionEnum.UrlParamNames.DISP_TYPE+"="+EBG.Semi.AttributionEnum.DisplayTypes.IFRAME,EBG.Semi.AttributionEnum.UrlParamNames.DISP_TYPE+"="+EBG.Semi.AttributionEnum.DisplayTypes.JAVASCRIPT)).replace("cn=ot","cn=ot&"+EBG.Semi.AttributionEnum.UrlParamNames.SEC_CALL+"=1"+(t.sessionId?"&sessionid="+t.sessionId:""));(u=this._addProviderUserId(u,t)).substr(u.indexOf(EBG.Semi.AttributionEnum.UrlParamNames.SYNC)+(EBG.Semi.AttributionEnum.UrlParamNames.SYNC+"=").length,1);this._onRequestSent(),this.serverCommunicator.sendRequest(u,(function(e,t){n.dp.log(EBG.DataProfile.SERVING,{status:t.status}),EBG.Semi.Infra.executeTextByScriptElem(document,e,(function(e){e?n.dp.log(EBG.DataProfile.SERVING,{malformed:1}):n._handleResponse({sendTime:(new Date).getTime()})}),n)}),(function(e,t,i){n.dp.log(EBG.DataProfile.SERVING,{retries:e,status:i.status,timeout:~~t})}),this)}},_onRequestSent:function(){this._totalRequests++,this.dp.log(EBG.DataProfile.SERVING,{total:this._totalRequests}),1==this._totalRequests&&this.dp.log(EBG.DataProfile.SERVING,{sendtime:(new Date).getTime()-this.inittime})},_runDeveloperScript:function(e,t){var i=this;try{if(e){var n=/[\s\S]*<script.*?>([\s\S]*)<\/script>[\s\S]*/g;if(e.match(n)){var r=n.exec(e);r.length>0&&EBG.Semi.Infra.executeTextByScriptElem(document,r[1]),t&&t.apply(i)}else{i=this;EBG.Semi.Infra.loadFileByScriptElem(document,e,(function(){t&&t.apply(i)}),0,this)}}else t&&t.apply(i)}catch(e){i._handleUnhandledError(e,2),t&&t.apply(i)}},fireRequest:function(e,t,i){var n=this;this._oneTagObj.dispType.toLowerCase()==EBG.Semi.AttributionEnum.DisplayTypes.IFRAME?(i+="&st="+(new Date).getTime(),this._isHandlingRequest=!1,EBGVT.Light.Infra.createUnfriendlyIframe(i,this._oneTagObj.sync)):this.serverCommunicator.sendRequest(i,(function(i,r){n.dp.log(EBG.DataProfile.SERVING,{status:r.status}),EBG.Semi.Infra.executeTextByScriptElem(document,i,function(e,t,i){return function(r){r?n.dp.log(EBG.DataProfile.SERVING,{malformed:1}):n._handleResponse({sessionId:e,id:t,sendTime:i})}}(t,e,(new Date).getTime()),n)}),(function(e,t,i){n.dp.log(EBG.DataProfile.SERVING,{retries:e,status:i.status,timeout:~~t})}),this),this._onRequestSent()},hasStorage:function(){try{return localStorage.setItem("eyeTesting","eyeTesting"),localStorage.removeItem("eyeTesting"),!0}catch(e){return!1}},getSessionId:function(){if(!this.hasStorage())return this.generateSessionId();var e="SZMKSessionId",t=null,i=new Date;if(n=localStorage.getItem(e))try{var n=JSON.parse(n);i.getTime()-n.time<=18e5&&(t=n.id)}catch(e){}t=t||this.generateSessionId();try{localStorage.setItem(e,JSON.stringify({time:i.getTime(),id:t}))}catch(e){}return t},getSZMKUin:function(){if(!this.hasStorage())return null;var e="SZMKUin";try{var t=localStorage.getItem(e);if(t)try{return JSON.parse(t)}catch(e){}var i=null;i={time:(new Date).getTime(),id:this.generateSessionId()},localStorage.setItem(e,JSON.stringify(i))}catch(e){}return i},generateSessionId:function(){var e="",t="12345678";e+=t.charAt(Math.floor(Math.random()*t.length)),t="0123456789";for(var i=0;i<18;i++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},setActivityParam:function(e,t){this._oneTagObj.activityParams||(this._oneTagObj.activityParams={}),this._oneTagObj.activityParams[e]=t},getActivityParam:function(e){var t=null;return this._oneTagObj.activityParams&&this._oneTagObj.activityParams[e]&&(t=this._oneTagObj.activityParams[e]),t},clearActivityParam:function(){this._oneTagObj.activityParams={}},setRetargetParam:function(e,t){this._oneTagObj.retargetParams||(this._oneTagObj.retargetParams={}),this._oneTagObj.retargetParams[e]=t},getRetargetParam:function(e){var t=null;return this._oneTagObj.retargetParams&&this._oneTagObj.retargetParams[e]&&(t=this._oneTagObj.retargetParams[e]),t},clearRetargetParam:function(){this._oneTagObj.retargetParams={}},setDynamicRetargetParam:function(e,t){this._oneTagObj.dynamicRetargetParams||(this._oneTagObj.dynamicRetargetParams={}),this._oneTagObj.dynamicRetargetParams[e]=t},getDynamicRetargetParam:function(e){var t=null;return this._oneTagObj.dynamicRetargetParams&&this._oneTagObj.dynamicRetargetParams[e]&&(t=this._oneTagObj.dynamicRetargetParams[e]),t},clearDynamicRetargetParam:function(){this._oneTagObj.dynamicRetargetParams={}},setConditionalParam:function(e,t){this._oneTagObj.conditionalParams||(this._oneTagObj.conditionalParams={}),this._oneTagObj.conditionalParams[e]=t},getConditionalParam:function(e){var t=null;return this._oneTagObj.conditionalParams&&this._oneTagObj.conditionalParams[e]&&(t=this._oneTagObj.conditionalParams[e]),t},clearConditionalParam:function(){this._oneTagObj.conditionalParams={}},_generateBsURL:function(e,t,i,n,r,a,s){e.bsUrl=e.bsUrl||"bs.serving-sys.com/Serving",e.bsUrl=e.bsUrl.replace(EBG.Semi.AttributionEnum.UrlParamNames.PREV_SERVING_PIPE,EBG.Semi.AttributionEnum.UrlParamNames.SERVING_PIPE);var o=this._getProtocol()+e.bsUrl+"?";if(this.ott.isActive()?o+="cn=ottp":o+="cn=ot",o+="&"+EBG.Semi.AttributionEnum.UrlParamNames.ID+"="+e.id+"&"+EBG.Semi.AttributionEnum.UrlParamNames.DISP_TYPE+"="+e.dispType+"&"+EBG.Semi.AttributionEnum.UrlParamNames.SYNC+"="+e.sync,i&&(o+="&"+EBG.Semi.AttributionEnum.UrlParamNames.SEC_CALL+"=1"),"0"!=n&&(o+="&"+EBG.Semi.AttributionEnum.UrlParamNames.SESSION_ID+"="+n),e.mobile&&(o+="&"+EBG.Semi.AttributionEnum.UrlParamNames.MOBILE+"="+e.mobile),r&&(o+="&"+EBG.Semi.AttributionEnum.UrlParamNames.BROWSER_EVENT+"="+r),a>=0&&(o+="&"+EBG.Semi.AttributionEnum.UrlParamNames.DI_APP_ID+"="+a),s&&(o+="&"+EBG.Semi.AttributionEnum.UrlParamNames.USER_COOKIE+"="+s),e.advertiserDeviceId&&(o+="&"+EBG.Semi.AttributionEnum.UrlParamNames.ADV_DEVICE_ID+"="+e.advertiserDeviceId),t=t||EBGVT.Light.Infra.getWindowLocation(),this.dp.log(EBG.DataProfile.SERVING,{pageurl:"string"==typeof t?t:EBGVT.Light.Infra.getWindowLocation().href}),i&&this.dp.log(EBG.DataProfile.SERVING,{seccall:1}),o+="&"+EBG.Semi.AttributionEnum.UrlParamNames.PAGE_URL+"=$$"+encodeURIComponent(t)+"$$",e.activityParams=e.activityParams||{},e.activityParams.Session=e.activityParams&&e.activityParams.Session||this.sessionId,o+=this._prepareParamUrl(e.activityParams,EBG.Semi.AttributionEnum.UrlParamNames.ACTIVITY_PARAMS),o+=this._prepareParamUrl(e.retargetParams,EBG.Semi.AttributionEnum.UrlParamNames.RETARGET_PARAMS),o+=this._prepareParamUrl(e.conditionalParams,EBG.Semi.AttributionEnum.UrlParamNames.CONDITIONAL_PARAMS),o+=this._prepareParamUrl(e.dynamicRetargetParams,EBG.Semi.AttributionEnum.UrlParamNames.DYNAMIC_RETARGET_PARAMS),this.ott.isActive()&&(o+="&tagsrunningmode="+this.ott.getDataCollectionOption()),e.dispType.toLowerCase()==EBG.Semi.AttributionEnum.DisplayTypes.IFRAME){var c=document.getElementById("ebOneTagUrlId");c&&(o+="&"+EBG.Semi.AttributionEnum.UrlParamNames.ONETAG_URL+"=$$"+encodeURIComponent(c.src)+"$$")}this.logNeeded&&(o+="&"+EBGVT.Light.Logger.DebugMode+"="+this.logNeeded),o+="&"+EBG.Semi.AttributionEnum.UrlParamNames.NO_SCRIPT+"=0",o+="&"+EBG.Semi.AttributionEnum.UrlParamNames.RANDOM+"="+EBGVT.Light.Infra.getRandomNumber(),e.debugData&&(o+="&"+e.debugData);var u=window,l=EBGVT.Light.Infra.getTopLevelReferrer(u);if(l){var d=EBGVT.Light.Infra.getTokenValueFromURL("ebReferrer",l);if(!s){var p=EBGVT.Light.Infra.getTokenValueFromURL(EBG.Semi.AttributionEnum.UrlParamNames.USER_COOKIE,l);p&&(o+="&usercookie=u2="+p)}var g=d||l;if(e.referralOnlyDomain){var f=document.createElement("a");f.setAttribute("href",g),f.search&&(g=f.toString().replace(f.search,""))}var m=EBGVT.Light.Infra.urlAvailableLength(o)-48;m>0&&(g.length>m&&(g=g.substr(0,m)),o+="&referrer=$$"+g+"$$")}var h=0,v=EBG.Semi.Infra.getQuerystringParam("etime");v&&!isNaN(v)&&(h=Date.now()/1e3-parseInt(v));if(0==this._totalRequests&&h<=900&&!EBG.Semi.Infra.isPageRefresh())for(var E,_=["gclid","msclkid","tmdata"],T=0;T<_.length;T++)if(E=EBG.Semi.Infra.getQuerystringParam(_[T])){if("tmdata"!=_[T])E='{"clkid":"'+E+'"}';else try{E=atob(E)}catch(e){this._handleUnhandledError(e,8)}o+="&"+EBG.Semi.AttributionEnum.UrlParamNames.POST_CLICK+"="+encodeURIComponent(E);break}if(e.uin&&this._getObjField(e.uin))try{o+="&"+EBG.Semi.AttributionEnum.UrlParamNames.UIN+"="+encodeURIComponent(JSON.stringify(e.uin))}catch(e){this._handleUnhandledError(e,2)}return EBGVT.Light.Infra.isDefined(e.optout)&&(o+="&"+EBG.Semi.AttributionEnum.UrlParamNames.OPTOUT+"="+e.optout),o},_prepareParamUrl:function(e,t){var i=!0,n="";for(var r in e)if(e.hasOwnProperty(r)&&(null!=e[r]&&t!=EBG.Semi.AttributionEnum.UrlParamNames.CONDITIONAL_PARAMS&&""!=e[r]||t==EBG.Semi.AttributionEnum.UrlParamNames.CONDITIONAL_PARAMS)){var a=encodeURIComponent(r+"="+e[r]);i?(n+="&"+t+"=$$"+a,i=!1):n+=encodeURIComponent("&")+a}return i||(n+="$$"),n},_getProtocol:function(){return"https://"},_getBsResponseContent:function(e){var t=e||this._oneTagObj;return bsResponseObj[t&&t.id&&t.sessionId?"ot"+t.id+"-"+t.sessionId:Object.keys(bsResponseObj)[0]]},_handleResponse:function(e,t){var i=null,n=this;try{this._totalResponses++,1==this._totalResponses&&this.dp.log(EBG.DataProfile.SERVING,{restime:(new Date).getTime()-this.inittime}),i=this._getBsResponseContent(e)}catch(r){return t=t||0,!i&&t<10?(t++,void setTimeout((function(){n._handleResponse.apply(n,[e,t])}),20)):void this._handleUnhandledError(r,9)}try{this.oneTagLogger.info("Server response: "+i);var r=this._deserializeResponse(i);if(i){if(i.extensionData){if(!e){e={};window.location.href;e.id=EBG.Semi.Infra.getQuerystringParam("onetagid"),e.sendTime=EBG.Semi.Infra.getQuerystringParam("st"),this.ott.isActive=function(){return!0}}this.ott.handleExtensionData(e.id,i.extensionData,(new Date).getTime(),e&&e.sendTime)}if(r.preServingTasks&&r.preServingTasks.length>0){var a={};a.uip=r.preServingTasks,a.uipv=r.uipv,a.scriptsPath=r.scriptsPath,a.filter=r.sessionId,this._oneTagObj?(a.bs=this._oneTagObj.bsUrl,a.ebPtcl=this._getProtocol()):(a.bs=document.domain,a.ebPtcl=this._getProtocol()),EBG.Semi.Events.eventMgr.subscribeToEvent(EBG.Semi.EventName.ALL_USER_ID_FOUND,this._getUserIdProviders,this,a.filter),this.uidProviders.getUserIds(a)}else r.firstPartyServingDomain?this.generateRequest(this.pageUrl,r,!0):(this._handleScriptTags(r.scripts),this._handleUrlTags(r.urls),r.customScript?this._handleCustomScript(r.customScript):this._oneTagObj&&this._oneTagObj.developerScripts&&this._oneTagObj.developerScripts.postScript&&(this._runDeveloperScript(this._oneTagObj.developerScripts.postScript),this._oneTagObj.developerScripts.postScript=null),this._handleServerMessages(r.logMessages),this._handleClientRules(r.clientRules||this._oneTagObj&&this._oneTagObj.clientRules,r.sessionId,r.diAppId,r.usercookie))}this._isHandlingRequest=!1}catch(e){this._handleUnhandledError(e)}},_getUserIdProviders:function(e){if(!this._userIdProvidersCalled){if(this._userIdProvidersCalled=!0,e){var t=this._deserializeResponse(this._getBsResponseContent());t.targetUrl=e.userIdStr}this._oneTagObj&&(this._oneTagObj.sync=0),this.generateRequest(this.pageUrl,t,!0)}},_handleClientRules:function(e,t,i,n){this.ruleManager||(this.ruleManager=new EBGVT.RuleManager(e,t,i,n,this))},_deserializeResponse:function(e){var t;if("object"==EBGVT.Light.Infra.typeOf(e))t=e;else try{this.logNeeded&&-1!=e.indexOf("/*")&&(e=e.substring(0,e.lastIndexOf("/*"))),t=EBGVT.JSON.parse(unescape(e))}catch(e){this.oneTagLogger.exception("OneTag._deserializeResponse",e)}return t},_handleCustomScript:function(e){if(e&&("http:"==e.substring(0,5).toLowerCase()||"https:"==e.substring(0,6).toLowerCase())){var t=document.createElement("script");t.type="text/javascript",t.src=e,EBGVT.Light.Infra.addScriptElement(t)}},_handleServerMessages:function(e){if(e&&e.length>0){this.oneTagLogger.timestamp=!1,this.oneTagLogger.info("Server Messages:");for(var t=0;t<e.length;t++)e[t]&&this.oneTagLogger.info("  "+e[t]);this.oneTagLogger.timestamp=!0}},_handleScriptTags:function(e){if(e)for(var t=0;t<e.length;t++)if(e[t])try{EBG.Semi.Infra.injectScript(unescape(e[t]))}catch(e){this._handleUnhandledError(e,1)}},_handleUrlTags:function(e){try{(e=this._replaceTokens(e))&&function(t){this.serverCommunicator.reportUrlsList(e,(function(e,i){e?this._handleUnhandledError(new Error(e+" : "+i),1):this.ott.send("timelines",{id:this._oneTagObj&&this._oneTagObj.id,name:i,type:"3rd Party URL",receiveTime:(new Date).getTime(),sendTime:t})}),this)}.apply(this,[(new Date).getTime()])}catch(e){this._handleUnhandledError(e)}},_replaceTokens:function(e){if(e=e||[],this.consentData)for(var t=0;t<e.length;t++){var i=e[t];if(this.consentData.gdprApplies&&(i=(i=(i=i.replace(/\[%gdpr%\]/gi,this.consentData.gdprApplies)).replace(/\${gdpr}/gi,this.consentData.gdprApplies)).replace(/{gdpr}/gi,this.consentData.gdprApplies)),this.consentData.consentData){i=(i=i.replace(/\[%gdpr_consent%\]/gi,this.consentData.consentData)).replace(/{gdpr_consent}/gi,this.consentData.consentData);var n=[1,2,4,6,7,8,9,10,11,12,13,14,15,16,18,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,36,37,39,40,41,42,44,45,46,47,48,49,50,51,52,53,56,57,58,59,60,61,62,63,65,66,67,68,69,70,71,72,73,75,76,77,78,79,80,82,83,84,85,86,87,88,89,90,91,92,93,94,95,97,98,100,101,102,104,108,109,110,111,114,115,119,120,122,124,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,147,148,149,150,151,152,153,154,155,157,158,159,160,161,162,163,164,165,167,168,170,173,174,177,178,179,183,184,185,190,192,193,194,195,196,198,199,200,202,203,205,206,208,209,210,211,212,213,215,216,217,218,223,224,226,227,228,230,231,234,235,236,237,238,239,240,241,242,243,244,246,248,249,250,251,252,253,254,255,256,259,261,262,263,264,265,266,270,272,273,274,275,276,277,278,279,280,281,282,284,285,289,290,293,294,295,297,298,299,301,302,303,304,308,310,311,312,314,315,316,317,318,319,321,323,325,328,329,331,333,334,335,336,337,343,345,347,349,350,351,354,358,359,360,361,365,368,371,373,374,375,377,378,380,381,382,384,385,387,388,394,397,402,408,409,410,412,413,415,416,418,422,423,424,427,428,429,431,434,435,436,438,439,440,444,447,448,450,452,455,458,459,461,462,466,467,468,469,471,473,475,479,482,484,486,488,490,491,493,495,496,497,498,501,502,505,506,507,508,509,511,512,516,517,519,520,521,524,527,528,530,531,535,536,539,541,543,544,545,546,547,549,550,553,554,556,559,561,565,568,569,570,571,573,574,577,578,579,580,581,584,587,590,591,593,596,597,598,599,601,602,606,607,609,610,612,613,614,615,617,618,620,621,624,625,626,628,630,631,638,639,644,645,646,647,648,649,650,652,653,654,655,656,657,658,659,662,663,664,665,666,667,668,670,671,672,674,675,676,678,681,682,683,684,685,686,687,688,690,691,694,697,699,702,703,706,707,708,709,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999,1e3,1001,1002,1003,1004,1005,1006,1007,1008,1009,1010,1011,1012,1013,1014,1015,1016,1018,1019,1020,1021,1022,1023,1024,1025,1026,1027,1028,1029,1030,1031,1032,1033,1034,1035,1036,1037,1038,1039,1040,1041,1042,1043,1044];if(/\${gdpr_consent_(.*?)}/gi.test(i))try{var r=i.match(/\${gdpr_consent_(.*?)}/gi);for(t=0;t<r.length;t++){var a=r[t].match(/\d+/);if(a&&-1!=n.indexOf(1*a[0])){var s="\\${gdpr_consent_"+a[0]+"}",o=new RegExp(s,"i");i=i.replace(o,this.consentData.consentData)}}}catch(e){}}e[t]=i}return e},_addProviderUserId:function(e,t){var i=EBGVT.Light.Infra.urlAvailableLength(e)-48;if(t.targetUrl)if(i>t.targetUrl.length)e+=t.targetUrl;else{var n=e.length+t.targetUrl.length+2;e+="&"+EEBG.Semi.AttributionEnum.UrlParamNames.ORIG_URL_LENGTH+"="+n}return e},_addGdprConsent:function(e,t){return t&&(t.gdprApplies&&(e+="&gdpr="+t.gdprApplies),t.consentData&&(e+="&gdpr_consent="+t.consentData)),e},_getOneTagScript:function(){var e;if(document.currentScript)e=document.currentScript;else{var t=document.getElementsByTagName("script");e=t[t.length-1]}return function(){return e}}()},gEBMainWindow=window.gEBMainWindow||EBG.Semi.WindowUtil.getTopWindow();var versaTagObj=new EBGVT.OneTag(window.versaTagObj);versaTagObj.onready((function(){this.generateRequest()}),!0);